# Отчёт по входному практическому тесту    
**Студент:** *Куманяев Никита*  
**Группа:** *241-351* 
**Вариант:** *3*  

---

## Задание 1.


**Ход выполнения:**
В задании был предоставлен текстовый файл с подозрительным содержимым. Требовалось найти флаг, скрытый в этом файле.
![Зад. 1 Скрин. 1](https://github.com/OakimPala/CTF/blob/main/%D0%A1%D0%BA%D1%80%D0%B8%D0%BD%D1%88%D0%BE%D1%82%D1%8B%20CTF/%D0%A0%D0%B0%D0%B1%D0%BE%D1%82%D0%B0%201/%D0%97%D0%B0%D0%B4%D0%B0%D0%BD%D0%B8%D0%B51/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA%20%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%202025-10-09%20215416.jpg?raw=true)
1. После открытия файла в текстовом редакторе я заметил большое количество необычных пробелов. Предположил, что флаг может быть закодирован именно в них.
![Зад. 1 Скрин. 2](https://github.com/OakimPala/CTF/blob/main/%D0%A1%D0%BA%D1%80%D0%B8%D0%BD%D1%88%D0%BE%D1%82%D1%8B%20CTF/%D0%A0%D0%B0%D0%B1%D0%BE%D1%82%D0%B0%201/%D0%97%D0%B0%D0%B4%D0%B0%D0%BD%D0%B8%D0%B51/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA%20%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%202025-10-09%20230649.jpg?raw=true)
2. Открыл файл в шестнадцатеричном редакторе *HxD*, однако никаких видимых аномалий не обнаружил.
3. Изучил дополнительные источники и нашёл рекомендации использовать утилиты Linux для анализа метаданных и скрытого содержимого: `file`, `exiftool`, `strings`.
4. Запустил виртуальную машину с установленной ОС Ubuntu и последовательно проверил файл этими утилитами. Результата не получил.
5. С помощью онлайн-сервиса (https://ctf.support/steganography/text-steganography/) нашел утилиту **stegsnow**.
6. Использовал утилиту stegsnow на файле memory_of_the_big_snow.txt
![Зад. 1 Скрин. 3](https://github.com/OakimPala/CTF/blob/main/%D0%A1%D0%BA%D1%80%D0%B8%D0%BD%D1%88%D0%BE%D1%82%D1%8B%20CTF/%D0%A0%D0%B0%D0%B1%D0%BE%D1%82%D0%B0%201/%D0%97%D0%B0%D0%B4%D0%B0%D0%BD%D0%B8%D0%B51/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA%20%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%202025-10-10%20232635.jpg?raw=true)
**Результат:**  
Найден флаг:

```
mospoly{1_l0v3_Th1S_W1nt3r_Vib3}
```

---

## Задание 2. Форензика

**Условие:**  
В задании был предоставлен файл захвата сетевого трафика (.pcap). Необходимо было найти флаг, передаваемый в одном из пакетов.

**Ход выполнения:**

1. Открыл файл в программе *Wireshark*.
2. Начал последовательный просмотр всех пакетов.
3. В пакете № 66, использующем протокол **HTTP**, обнаружил передачу файла с именем `flag.txt`.
4. Щёлкнул правой кнопкой мыши по пакету и выбрал пункт **Следовать → Поток TCP** (*Follow TCP Stream*).
5. В открывшемся окне отображалось содержимое передаваемого файла, в котором и находился флаг.
![Зад. 2 Скрин. 1](https://github.com/OakimPala/CTF/blob/main/%D0%A1%D0%BA%D1%80%D0%B8%D0%BD%D1%88%D0%BE%D1%82%D1%8B%20CTF/%D0%A0%D0%B0%D0%B1%D0%BE%D1%82%D0%B0%201/%D0%97%D0%B0%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5%203/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA%20%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%202025-10-10%20013224.jpg?raw=true)

**Результат:**  
Найден флаг:

```
mospoly{Bas3_f0rEns1cS_tAsK}
```

---

## Задание 3. Криптография

**Условие:**  
Название:
```
Rails-rails, sleepers-sleepers
```
Описание:
```
Cryptography Сможешь это расшифровать? Лично я знаю этот шифр, как свои 5 пальцев...
```

Дана зашифрованная строка:

```
Tlt cmahs eohe tr or lel ateraes yfride crnwpln{Am1o_S3oC3}
Формат флага: mospoly{}
```

**Ход выполнения:**

1. Сначала проверил распространённые классические шифры:
   - Атбаш;
   - Цезарь (со смещениями 3, 5 и –5);
   - Шифр Тритемия;
   - Шифр Белазо (с предполагаемым ключом *F*, так как это пятая буква алфавита).  
     Результата не получил.
2. После этого перешёл к анализу фразы «Rails-rails, sleepers-sleepers», предположив, что она является подсказкой к **шифру рельсового забора (Rail Fence Cipher)**.
3. С помощью различных онлайн-декодеров и самописных скриптов перебрал варианты количества «рельсов» от 2 до 20.
4. Проверил комбинации с другими шифрами (например, Rail Fence → Caesar), однако ни один из вариантов не дал корректного результата.

**Результат:**  
Флаг не найден.  

---

## Задание 4. Forensics and Reversing

**Условие:**  
Был предоставлен файл с Python-кодом (`muhehehe.py`).  
После запуска программа просила ввести число от 1 до 10 и затем любимое животное. При вводе различных значений результат отсутствовал. Требовалось извлечь флаг путём анализа и реверс-инжиниринга кода.

**Ход выполнения:**

1. Открыл файл в текстовом редакторе и обнаружил обфусцированный код, содержащий выражение:
   ```python
   exec((_)(b'...'))
   ```
   Это указывало на то, что программа выполняет байтовый блок, предварительно декодируя и распаковывая его.
2. Для безопасного анализа перенёс файл в виртуальную машину Linux и создал вспомогательные каталоги.
3. Изучив структуру, определил, что код использует комбинацию обратных преобразований:  
   **переворот байтов → Base64-декодирование → распаковка zlib.**
4. Написал собственный скрипт `find_flag_final.py`, выполняющий безопасную автоматическую рекурсивную декомпрессию без исполнения кода.  
   Скрипт поэтапно:
   - ищет байтовый литерал в исходном файле;
   - выполняет обратные преобразования (переворот, Base64, zlib);
   - сохраняет каждый уровень в файлы `muhehehe.decoded.iterN.py`;
   - ищет в тексте шаблон флага `mospoly{...}`.
5. После нескольких десятков итераций скрипт успешно распознал скрытое сообщение.
![Зад. 4 Скрин. 1](https://github.com/OakimPala/CTF/blob/main/%D0%A1%D0%BA%D1%80%D0%B8%D0%BD%D1%88%D0%BE%D1%82%D1%8B%20CTF/%D0%A0%D0%B0%D0%B1%D0%BE%D1%82%D0%B0%201/%D0%97%D0%B0%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5%204/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA%20%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%202025-10-10%20230416.jpg?raw=true)

**Результат:**  
Найден флаг:

```
mospoly{t1_cht0_ugadal?}
```

---

## Заключение

В ходе выполнения лабораторной работы были применены методы анализа цифровых данных, стеганографии, сетевой форензики, криптографического анализа и реверс-инжиниринга.  
Для поиска флагов использовались следующие инструменты и подходы:

- **Стеганография:** утилита *stegsnow* и онлайн-декодер текстовой стеганографии.  
- **Форензика:** программа *Wireshark* для анализа TCP-потока.  
- **Криптография:** классические шифры (Атбаш, Цезарь, Тритемий, Белазо, Rail Fence).  
- **Реверс-инжиниринг:** анализ Python-обфускации и написание собственного декодера на языке Python.




